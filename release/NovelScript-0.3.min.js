!function(e){var t={};t.setPositionRelative=function(e){e.css("position","relative")},t.setPositionAbsolute=function(e){e.css("position","absolute")},t.getReletiveLeft=function(e){var t=e.parent();return(t.width()-e.width())/2},t.getWindowLeft=function(t){return(e(window).width()-t.width())/2},t.getReletiveTop=function(e){var t=e.parent();return(t.height()-e.height())/2},t.getWindowTop=function(t){return(e(window).height()-t.height())/2},t.horizontal=function(e){t.setPositionRelative(e),e.css("left",t.getReletiveLeft(e))},t.vertical=function(e){t.setPositionRelative(e),e.css("top",t.getReletiveTop(e))},t.fullHorizontal=function(e){t.setPositionAbsolute(e),e.css("left",t.getWindowLeft(e))},t.fullVertical=function(e){t.setPositionAbsolute(e),e.css("top",t.getWindowTop(e))},t.full=function(e){t.setPositionRelative(e),e.css("left",t.getReletiveLeft(e)),e.css("top",t.getReletiveTop(e))},t.fullscreen=function(e){t.setPositionAbsolute(e),e.css("left",t.getWindowLeft(e)),e.css("top",t.getWindowTop(e))},e.fn.extend({align:function(s){return t[s](e(this)),e(this)}})}(jQuery),this.createjs=this.createjs||{},function(){"use strict";var e=createjs.PreloadJS=createjs.PreloadJS||{};e.version="0.6.2",e.buildDate="Thu, 26 Nov 2015 20:44:31 GMT"}(),this.createjs=this.createjs||{},createjs.extend=function(e,t){"use strict";function s(){this.constructor=e}return s.prototype=t.prototype,e.prototype=new s},this.createjs=this.createjs||{},createjs.promote=function(e,t){"use strict";var s=e.prototype,r=Object.getPrototypeOf&&Object.getPrototypeOf(s)||s.__proto__;if(r){s[(t+="_")+"constructor"]=r.constructor;for(var i in r)s.hasOwnProperty(i)&&"function"==typeof r[i]&&(s[t+i]=r[i])}return e},this.createjs=this.createjs||{},function(){"use strict";createjs.proxy=function(e,t){var s=Array.prototype.slice.call(arguments,2);return function(){return e.apply(t,Array.prototype.slice.call(arguments,0).concat(s))}}}(),this.createjs=this.createjs||{},createjs.indexOf=function(e,t){"use strict";for(var s=0,r=e.length;r>s;s++)if(t===e[s])return s;return-1},this.createjs=this.createjs||{},function(){"use strict";function e(e,t,s){this.type=e,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!t,this.cancelable=!!s,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var t=e.prototype;t.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},t.stopPropagation=function(){this.propagationStopped=!0},t.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},t.remove=function(){this.removed=!0},t.clone=function(){return new e(this.type,this.bubbles,this.cancelable)},t.set=function(e){for(var t in e)this[t]=e[t];return this},t.toString=function(){return"[Event (type="+this.type+")]"},createjs.Event=e}(),this.createjs=this.createjs||{},function(){"use strict";function e(e,t,s){this.Event_constructor("error"),this.title=e,this.message=t,this.data=s}var t=createjs.extend(e,createjs.Event);t.clone=function(){return new createjs.ErrorEvent(this.title,this.message,this.data)},createjs.ErrorEvent=createjs.promote(e,"Event")}(),this.createjs=this.createjs||{},function(){"use strict";function e(){this._listeners=null,this._captureListeners=null}var t=e.prototype;e.initialize=function(e){e.addEventListener=t.addEventListener,e.on=t.on,e.removeEventListener=e.off=t.removeEventListener,e.removeAllEventListeners=t.removeAllEventListeners,e.hasEventListener=t.hasEventListener,e.dispatchEvent=t.dispatchEvent,e._dispatchEvent=t._dispatchEvent,e.willTrigger=t.willTrigger},t.addEventListener=function(e,t,s){var r;r=s?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{};var i=r[e];return i&&this.removeEventListener(e,t,s),i=r[e],i?i.push(t):r[e]=[t],t},t.on=function(e,t,s,r,i,n){return t.handleEvent&&(s=s||t,t=t.handleEvent),s=s||this,this.addEventListener(e,function(e){t.call(s,e,i),r&&e.remove()},n)},t.removeEventListener=function(e,t,s){var r=s?this._captureListeners:this._listeners;if(r){var i=r[e];if(i)for(var n=0,a=i.length;a>n;n++)if(i[n]==t){1==a?delete r[e]:i.splice(n,1);break}}},t.off=t.removeEventListener,t.removeAllEventListeners=function(e){e?(this._listeners&&delete this._listeners[e],this._captureListeners&&delete this._captureListeners[e]):this._listeners=this._captureListeners=null},t.dispatchEvent=function(e,t,s){if("string"==typeof e){var r=this._listeners;if(!(t||r&&r[e]))return!0;e=new createjs.Event(e,t,s)}else e.target&&e.clone&&(e=e.clone());try{e.target=this}catch(e){}if(e.bubbles&&this.parent){for(var i=this,n=[i];i.parent;)n.push(i=i.parent);var a,o=n.length;for(a=o-1;a>=0&&!e.propagationStopped;a--)n[a]._dispatchEvent(e,1+(0==a));for(a=1;o>a&&!e.propagationStopped;a++)n[a]._dispatchEvent(e,3)}else this._dispatchEvent(e,2);return!e.defaultPrevented},t.hasEventListener=function(e){var t=this._listeners,s=this._captureListeners;return!!(t&&t[e]||s&&s[e])},t.willTrigger=function(e){for(var t=this;t;){if(t.hasEventListener(e))return!0;t=t.parent}return!1},t.toString=function(){return"[EventDispatcher]"},t._dispatchEvent=function(e,t){var s,r=1==t?this._captureListeners:this._listeners;if(e&&r){var i=r[e.type];if(!i||!(s=i.length))return;try{e.currentTarget=this}catch(e){}try{e.eventPhase=t}catch(e){}e.removed=!1,i=i.slice();for(var n=0;s>n&&!e.immediatePropagationStopped;n++){var a=i[n];a.handleEvent?a.handleEvent(e):a(e),e.removed&&(this.off(e.type,a,1==t),e.removed=!1)}}},createjs.EventDispatcher=e}(),this.createjs=this.createjs||{},function(){"use strict";function e(e,t){this.Event_constructor("progress"),this.loaded=e,this.total=null==t?1:t,this.progress=0==t?0:this.loaded/this.total}var t=createjs.extend(e,createjs.Event);t.clone=function(){return new createjs.ProgressEvent(this.loaded,this.total)},createjs.ProgressEvent=createjs.promote(e,"Event")}(window),function(){function e(t,r){function n(e){if(n[e]!==_)return n[e];var t;if("bug-string-char-index"==e)t="a"!="a"[0];else if("json"==e)t=n("json-stringify")&&n("json-parse");else{var s,i='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var c=r.stringify,h="function"==typeof c&&b;if(h){(s=function(){return 1}).toJSON=s;try{h="0"===c(0)&&"0"===c(new a)&&'""'==c(new o)&&c(v)===_&&c(_)===_&&c()===_&&"1"===c(s)&&"[1]"==c([s])&&"[null]"==c([_])&&"null"==c(null)&&"[null,null,null]"==c([_,v,null])&&c({a:[s,!0,!1,null,"\0\b\n\f\r\t"]})==i&&"1"===c(null,s)&&"[\n 1,\n 2\n]"==c([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==c(new l(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==c(new l(864e13))&&'"-000001-01-01T00:00:00.000Z"'==c(new l(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==c(new l(-1))}catch(e){h=!1}}t=h}if("json-parse"==e){var u=r.parse;if("function"==typeof u)try{if(0===u("0")&&!u(!1)){s=u(i);var d=5==s.a.length&&1===s.a[0];if(d){try{d=!u('"\t"')}catch(e){}if(d)try{d=1!==u("01")}catch(e){}if(d)try{d=1!==u("1.")}catch(e){}}}}catch(e){d=!1}t=d}}return n[e]=!!t}t||(t=i.Object()),r||(r=i.Object());var a=t.Number||i.Number,o=t.String||i.String,c=t.Object||i.Object,l=t.Date||i.Date,h=t.SyntaxError||i.SyntaxError,u=t.TypeError||i.TypeError,d=t.Math||i.Math,f=t.JSON||i.JSON;"object"==typeof f&&f&&(r.stringify=f.stringify,r.parse=f.parse);var p,g,_,m=c.prototype,v=m.toString,b=new l(-0xc782b5b800cec);try{b=-109252==b.getUTCFullYear()&&0===b.getUTCMonth()&&1===b.getUTCDate()&&10==b.getUTCHours()&&37==b.getUTCMinutes()&&6==b.getUTCSeconds()&&708==b.getUTCMilliseconds()}catch(e){}if(!n("json")){var y="[object Function]",L="[object Date]",S="[object Number]",j="[object String]",E="[object Array]",w="[object Boolean]",T=n("bug-string-char-index");if(!b)var R=d.floor,A=[0,31,59,90,120,151,181,212,243,273,304,334],x=function(e,t){return A[t]+365*(e-1970)+R((e-1969+(t=+(t>1)))/4)-R((e-1901+t)/100)+R((e-1601+t)/400)};if((p=m.hasOwnProperty)||(p=function(e){var t,s={};return(s.__proto__=null,s.__proto__={toString:1},s).toString!=v?p=function(e){var t=this.__proto__,s=e in(this.__proto__=null,this);return this.__proto__=t,s}:(t=s.constructor,p=function(e){var s=(this.constructor||t).prototype;return e in this&&!(e in s&&this[e]===s[e])}),s=null,p.call(this,e)}),g=function(e,t){var r,i,n,a=0;(r=function(){this.valueOf=0}).prototype.valueOf=0,i=new r;for(n in i)p.call(i,n)&&a++;return r=i=null,a?g=2==a?function(e,t){var s,r={},i=v.call(e)==y;for(s in e)i&&"prototype"==s||p.call(r,s)||!(r[s]=1)||!p.call(e,s)||t(s)}:function(e,t){var s,r,i=v.call(e)==y;for(s in e)i&&"prototype"==s||!p.call(e,s)||(r="constructor"===s)||t(s);(r||p.call(e,s="constructor"))&&t(s)}:(i=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],g=function(e,t){var r,n,a=v.call(e)==y,o=!a&&"function"!=typeof e.constructor&&s[typeof e.hasOwnProperty]&&e.hasOwnProperty||p;for(r in e)a&&"prototype"==r||!o.call(e,r)||t(r);for(n=i.length;r=i[--n];o.call(e,r)&&t(r));}),g(e,t)},!n("json-stringify")){var I={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},P="000000",O=function(e,t){return(P+(t||0)).slice(-e)},k="\\u00",C=function(e){for(var t='"',s=0,r=e.length,i=!T||r>10,n=i&&(T?e.split(""):e);r>s;s++){var a=e.charCodeAt(s);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=I[a];break;default:if(32>a){t+=k+O(2,a.toString(16));break}t+=i?n[s]:e.charAt(s)}}return t+'"'},M=function(e,t,s,r,i,n,a){var o,c,l,h,d,f,m,b,y,T,A,I,P,k,q,$;try{o=t[e]}catch(e){}if("object"==typeof o&&o)if(c=v.call(o),c!=L||p.call(o,"toJSON"))"function"==typeof o.toJSON&&(c!=S&&c!=j&&c!=E||p.call(o,"toJSON"))&&(o=o.toJSON(e));else if(o>-1/0&&1/0>o){if(x){for(d=R(o/864e5),l=R(d/365.2425)+1970-1;x(l+1,0)<=d;l++);for(h=R((d-x(l,0))/30.42);x(l,h+1)<=d;h++);d=1+d-x(l,h),f=(o%864e5+864e5)%864e5,m=R(f/36e5)%24,b=R(f/6e4)%60,y=R(f/1e3)%60,T=f%1e3}else l=o.getUTCFullYear(),h=o.getUTCMonth(),d=o.getUTCDate(),m=o.getUTCHours(),b=o.getUTCMinutes(),y=o.getUTCSeconds(),T=o.getUTCMilliseconds();o=(0>=l||l>=1e4?(0>l?"-":"+")+O(6,0>l?-l:l):O(4,l))+"-"+O(2,h+1)+"-"+O(2,d)+"T"+O(2,m)+":"+O(2,b)+":"+O(2,y)+"."+O(3,T)+"Z"}else o=null;if(s&&(o=s.call(t,e,o)),null===o)return"null";if(c=v.call(o),c==w)return""+o;if(c==S)return o>-1/0&&1/0>o?""+o:"null";if(c==j)return C(""+o);if("object"==typeof o){for(k=a.length;k--;)if(a[k]===o)throw u();if(a.push(o),A=[],q=n,n+=i,c==E){for(P=0,k=o.length;k>P;P++)I=M(P,o,s,r,i,n,a),A.push(I===_?"null":I);$=A.length?i?"[\n"+n+A.join(",\n"+n)+"\n"+q+"]":"["+A.join(",")+"]":"[]"}else g(r||o,function(e){var t=M(e,o,s,r,i,n,a);t!==_&&A.push(C(e)+":"+(i?" ":"")+t)}),$=A.length?i?"{\n"+n+A.join(",\n"+n)+"\n"+q+"}":"{"+A.join(",")+"}":"{}";return a.pop(),$}};r.stringify=function(e,t,r){var i,n,a,o;if(s[typeof t]&&t)if((o=v.call(t))==y)n=t;else if(o==E){a={};for(var c,l=0,h=t.length;h>l;c=t[l++],o=v.call(c),(o==j||o==S)&&(a[c]=1));}if(r)if((o=v.call(r))==S){if((r-=r%1)>0)for(i="",r>10&&(r=10);i.length<r;i+=" ");}else o==j&&(i=r.length<=10?r:r.slice(0,10));return M("",(c={},c[""]=e,c),n,a,i,"",[])}}if(!n("json-parse")){var q,$,N=o.fromCharCode,F={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},H=function(){throw q=$=null,h()},X=function(){for(var e,t,s,r,i,n=$,a=n.length;a>q;)switch(i=n.charCodeAt(q)){case 9:case 10:case 13:case 32:q++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=T?n.charAt(q):n[q],q++,e;case 34:for(e="@",q++;a>q;)if(i=n.charCodeAt(q),32>i)H();else if(92==i)switch(i=n.charCodeAt(++q)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=F[i],q++;break;case 117:for(t=++q,s=q+4;s>q;q++)i=n.charCodeAt(q),i>=48&&57>=i||i>=97&&102>=i||i>=65&&70>=i||H();e+=N("0x"+n.slice(t,q));break;default:H()}else{if(34==i)break;for(i=n.charCodeAt(q),t=q;i>=32&&92!=i&&34!=i;)i=n.charCodeAt(++q);e+=n.slice(t,q)}if(34==n.charCodeAt(q))return q++,e;H();default:if(t=q,45==i&&(r=!0,i=n.charCodeAt(++q)),i>=48&&57>=i){for(48==i&&(i=n.charCodeAt(q+1),i>=48&&57>=i)&&H(),r=!1;a>q&&(i=n.charCodeAt(q),i>=48&&57>=i);q++);if(46==n.charCodeAt(q)){for(s=++q;a>s&&(i=n.charCodeAt(s),i>=48&&57>=i);s++);s==q&&H(),q=s}if(i=n.charCodeAt(q),101==i||69==i){for(i=n.charCodeAt(++q),(43==i||45==i)&&q++,s=q;a>s&&(i=n.charCodeAt(s),i>=48&&57>=i);s++);s==q&&H(),q=s}return+n.slice(t,q)}if(r&&H(),"true"==n.slice(q,q+4))return q+=4,!0;if("false"==n.slice(q,q+5))return q+=5,!1;if("null"==n.slice(q,q+4))return q+=4,null;H()}return"$"},U=function(e){var t,s;if("$"==e&&H(),"string"==typeof e){if("@"==(T?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=X(),"]"!=e;s||(s=!0))s&&(","==e?(e=X(),"]"==e&&H()):H()),","==e&&H(),t.push(U(e));return t}if("{"==e){for(t={};e=X(),"}"!=e;s||(s=!0))s&&(","==e?(e=X(),"}"==e&&H()):H()),(","==e||"string"!=typeof e||"@"!=(T?e.charAt(0):e[0])||":"!=X())&&H(),t[e.slice(1)]=U(X());return t}H()}return e},D=function(e,t,s){var r=B(e,t,s);r===_?delete e[t]:e[t]=r},B=function(e,t,s){var r,i=e[t];if("object"==typeof i&&i)if(v.call(i)==E)for(r=i.length;r--;)D(i,r,s);else g(i,function(e){D(i,e,s)});return s.call(e,t,i)};r.parse=function(e,t){var s,r;return q=0,$=""+e,s=U(X()),"$"!=X()&&H(),q=$=null,t&&v.call(t)==y?B((r={},r[""]=s,r),"",t):s}}}return r.runInContext=e,r}var t="function"==typeof define&&define.amd,s={function:!0,object:!0},r=s[typeof exports]&&exports&&!exports.nodeType&&exports,i=s[typeof window]&&window||this,n=r&&s[typeof module]&&module&&!module.nodeType&&"object"==typeof global&&global;if(!n||n.global!==n&&n.window!==n&&n.self!==n||(i=n),r&&!t)e(i,r);else{var a=i.JSON,o=i.JSON3,c=!1,l=e(i,i.JSON3={noConflict:function(){return c||(c=!0,i.JSON=a,i.JSON3=o,a=o=null),l}});i.JSON={parse:l.parse,stringify:l.stringify}}t&&define(function(){return l})}.call(this),function(){var e={};e.appendToHead=function(t){e.getHead().appendChild(t)},e.getHead=function(){return document.head||document.getElementsByTagName("head")[0]},e.getBody=function(){return document.body||document.getElementsByTagName("body")[0]},createjs.DomUtils=e}(),function(){var e={};e.parseXML=function(e,t){var s=null;try{if(window.DOMParser){var r=new DOMParser;s=r.parseFromString(e,t)}}catch(e){}if(!s)try{s=new ActiveXObject("Microsoft.XMLDOM"),s.async=!1,s.loadXML(e)}catch(e){s=null}return s},e.parseJSON=function(e){if(null==e)return null;try{return JSON.parse(e)}catch(e){throw e}},createjs.DataUtils=e}(),this.createjs=this.createjs||{},function(){"use strict";function e(){this.src=null,this.type=null,this.id=null,this.maintainOrder=!1,this.callback=null,this.data=null,this.method=createjs.LoadItem.GET,this.values=null,this.headers=null,this.withCredentials=!1,this.mimeType=null,this.crossOrigin=null,this.loadTimeout=s.LOAD_TIMEOUT_DEFAULT}var t=e.prototype={},s=e;s.LOAD_TIMEOUT_DEFAULT=8e3,s.create=function(t){if("string"==typeof t){var r=new e;return r.src=t,r}if(t instanceof s)return t;if(t instanceof Object&&t.src)return null==t.loadTimeout&&(t.loadTimeout=s.LOAD_TIMEOUT_DEFAULT),t;throw new Error("Type not recognized.")},t.set=function(e){for(var t in e)this[t]=e[t];return this},createjs.LoadItem=s}(),function(){var e={};e.ABSOLUTE_PATT=/^(?:\w+:)?\/{2}/i,e.RELATIVE_PATT=/^[.\/]*?\//i,e.EXTENSION_PATT=/\/?[^\/]+\.(\w{1,5})$/i,e.parseURI=function(t){var s={absolute:!1,relative:!1};if(null==t)return s;var r=t.indexOf("?");r>-1&&(t=t.substr(0,r));var i;return e.ABSOLUTE_PATT.test(t)?s.absolute=!0:e.RELATIVE_PATT.test(t)&&(s.relative=!0),(i=t.match(e.EXTENSION_PATT))&&(s.extension=i[1].toLowerCase()),s},e.formatQueryString=function(e,t){if(null==e)throw new Error("You must specify data.");var s=[];for(var r in e)s.push(r+"="+escape(e[r]));return t&&(s=s.concat(t)),s.join("&")},e.buildPath=function(e,t){if(null==t)return e;var s=[],r=e.indexOf("?");if(-1!=r){var i=e.slice(r+1);s=s.concat(i.split("&"))}return-1!=r?e.slice(0,r)+"?"+this.formatQueryString(t,s):e+"?"+this.formatQueryString(t,s)},e.isCrossDomain=function(e){var t=document.createElement("a");t.href=e.src;var s=document.createElement("a");s.href=location.href;var r=""!=t.hostname&&(t.port!=s.port||t.protocol!=s.protocol||t.hostname!=s.hostname);return r},e.isLocal=function(e){var t=document.createElement("a");return t.href=e.src,""==t.hostname&&"file:"==t.protocol},e.isBinary=function(e){switch(e){case createjs.AbstractLoader.IMAGE:case createjs.AbstractLoader.BINARY:return!0;default:return!1}},e.isImageTag=function(e){return e instanceof HTMLImageElement},e.isAudioTag=function(e){return!!window.HTMLAudioElement&&e instanceof HTMLAudioElement},e.isVideoTag=function(e){return!!window.HTMLVideoElement&&e instanceof HTMLVideoElement},e.isText=function(e){switch(e){case createjs.AbstractLoader.TEXT:case createjs.AbstractLoader.JSON:case createjs.AbstractLoader.MANIFEST:case createjs.AbstractLoader.XML:case createjs.AbstractLoader.CSS:case createjs.AbstractLoader.SVG:case createjs.AbstractLoader.JAVASCRIPT:case createjs.AbstractLoader.SPRITESHEET:return!0;default:return!1}},e.getTypeByExtension=function(e){if(null==e)return createjs.AbstractLoader.TEXT;switch(e.toLowerCase()){case"jpeg":case"jpg":case"gif":case"png":case"webp":case"bmp":return createjs.AbstractLoader.IMAGE;case"ogg":case"mp3":case"webm":return createjs.AbstractLoader.SOUND;case"mp4":case"webm":case"ts":return createjs.AbstractLoader.VIDEO;case"json":return createjs.AbstractLoader.JSON;case"xml":return createjs.AbstractLoader.XML;case"css":return createjs.AbstractLoader.CSS;case"js":return createjs.AbstractLoader.JAVASCRIPT;case"svg":return createjs.AbstractLoader.SVG;default:return createjs.AbstractLoader.TEXT}},createjs.RequestUtils=e}(),this.createjs=this.createjs||{},function(){"use strict";function e(e,t,s){this.EventDispatcher_constructor(),this.loaded=!1,this.canceled=!1,this.progress=0,this.type=s,this.resultFormatter=null,this._item=e?createjs.LoadItem.create(e):null,this._preferXHR=t,this._result=null,this._rawResult=null,this._loadedItems=null,this._tagSrcAttribute=null,this._tag=null}var t=createjs.extend(e,createjs.EventDispatcher),s=e;s.POST="POST",s.GET="GET",s.BINARY="binary",s.CSS="css",s.IMAGE="image",s.JAVASCRIPT="javascript",s.JSON="json",s.JSONP="jsonp",s.MANIFEST="manifest",s.SOUND="sound",s.VIDEO="video",s.SPRITESHEET="spritesheet",s.SVG="svg",s.TEXT="text",s.XML="xml",t.getItem=function(){return this._item},t.getResult=function(e){return e?this._rawResult:this._result},t.getTag=function(){return this._tag},t.setTag=function(e){this._tag=e},t.load=function(){this._createRequest(),this._request.on("complete",this,this),this._request.on("progress",this,this),this._request.on("loadStart",this,this),this._request.on("abort",this,this),this._request.on("timeout",this,this),this._request.on("error",this,this);var e=new createjs.Event("initialize");e.loader=this._request,this.dispatchEvent(e),this._request.load()},t.cancel=function(){this.canceled=!0,this.destroy()},t.destroy=function(){this._request&&(this._request.removeAllEventListeners(),this._request.destroy()),this._request=null,this._item=null,this._rawResult=null,this._result=null,this._loadItems=null,this.removeAllEventListeners()},t.getLoadedItems=function(){return this._loadedItems},t._createRequest=function(){this._request=this._preferXHR?new createjs.XHRRequest(this._item):new createjs.TagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},t._createTag=function(){return null},t._sendLoadStart=function(){this._isCanceled()||this.dispatchEvent("loadstart")},t._sendProgress=function(e){if(!this._isCanceled()){var t=null;"number"==typeof e?(this.progress=e,t=new createjs.ProgressEvent(this.progress)):(t=e,this.progress=e.loaded/e.total,t.progress=this.progress,(isNaN(this.progress)||1/0==this.progress)&&(this.progress=0)),this.hasEventListener("progress")&&this.dispatchEvent(t)}},t._sendComplete=function(){if(!this._isCanceled()){this.loaded=!0;var e=new createjs.Event("complete");e.rawResult=this._rawResult,null!=this._result&&(e.result=this._result),this.dispatchEvent(e)}},t._sendError=function(e){!this._isCanceled()&&this.hasEventListener("error")&&(null==e&&(e=new createjs.ErrorEvent("PRELOAD_ERROR_EMPTY")),this.dispatchEvent(e))},t._isCanceled=function(){return!(null!=window.createjs&&!this.canceled)},t.resultFormatter=null,t.handleEvent=function(e){switch(e.type){case"complete":this._rawResult=e.target._response;var t=this.resultFormatter&&this.resultFormatter(this);t instanceof Function?t.call(this,createjs.proxy(this._resultFormatSuccess,this),createjs.proxy(this._resultFormatFailed,this)):(this._result=t||this._rawResult,this._sendComplete());break;case"progress":this._sendProgress(e);break;case"error":this._sendError(e);break;case"loadstart":this._sendLoadStart();break;case"abort":case"timeout":this._isCanceled()||this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_"+e.type.toUpperCase()+"_ERROR"))}},t._resultFormatSuccess=function(e){this._result=e,this._sendComplete()},t._resultFormatFailed=function(e){this._sendError(e)},t.buildPath=function(e,t){return createjs.RequestUtils.buildPath(e,t)},t.toString=function(){return"[PreloadJS AbstractLoader]"},createjs.AbstractLoader=createjs.promote(e,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e,t,s){this.AbstractLoader_constructor(e,t,s),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",this.on("initialize",this._updateXHR,this)}var t=createjs.extend(e,createjs.AbstractLoader);t.load=function(){this._tag||(this._tag=this._createTag(this._item.src)),this._tag.preload="auto",this._tag.load(),this.AbstractLoader_load()},t._createTag=function(){},t._createRequest=function(){this._request=this._preferXHR?new createjs.XHRRequest(this._item):new createjs.MediaTagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},t._updateXHR=function(e){e.loader.setResponseType&&e.loader.setResponseType("blob")},t._formatResult=function(e){if(this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.onstalled=null,this._preferXHR){var t=window.URL||window.webkitURL,s=e.getResult(!0);e.getTag().src=t.createObjectURL(s)}return e.getTag()},createjs.AbstractMediaLoader=createjs.promote(e,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";var e=function(e){this._item=e},t=createjs.extend(e,createjs.EventDispatcher);t.load=function(){},t.destroy=function(){},t.cancel=function(){},createjs.AbstractRequest=createjs.promote(e,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e,t,s){this.AbstractRequest_constructor(e),this._tag=t,this._tagSrcAttribute=s,this._loadedHandler=createjs.proxy(this._handleTagComplete,this),this._addedToDOM=!1,this._startTagVisibility=null}var t=createjs.extend(e,createjs.AbstractRequest);t.load=function(){this._tag.onload=createjs.proxy(this._handleTagComplete,this),this._tag.onreadystatechange=createjs.proxy(this._handleReadyStateChange,this),this._tag.onerror=createjs.proxy(this._handleError,this);var e=new createjs.Event("initialize");e.loader=this._tag,this.dispatchEvent(e),this._hideTag(),this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag[this._tagSrcAttribute]=this._item.src,null==this._tag.parentNode&&(window.document.body.appendChild(this._tag),this._addedToDOM=!0)},t.destroy=function(){this._clean(),this._tag=null,this.AbstractRequest_destroy()},t._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var e=this._tag;("loaded"==e.readyState||"complete"==e.readyState)&&this._handleTagComplete()},t._handleError=function(){this._clean(),this.dispatchEvent("error")},t._handleTagComplete=function(){this._rawResult=this._tag,this._result=this.resultFormatter&&this.resultFormatter(this)||this._rawResult,this._clean(),this._showTag(),this.dispatchEvent("complete")},t._handleTimeout=function(){this._clean(),this.dispatchEvent(new createjs.Event("timeout"))},t._clean=function(){this._tag.onload=null,this._tag.onreadystatechange=null,this._tag.onerror=null,this._addedToDOM&&null!=this._tag.parentNode&&this._tag.parentNode.removeChild(this._tag),clearTimeout(this._loadTimeout)},t._hideTag=function(){this._startTagVisibility=this._tag.style.visibility,this._tag.style.visibility="hidden"},t._showTag=function(){this._tag.style.visibility=this._startTagVisibility},t._handleStalled=function(){},createjs.TagRequest=createjs.promote(e,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e,t,s){this.AbstractRequest_constructor(e),this._tag=t,this._tagSrcAttribute=s,this._loadedHandler=createjs.proxy(this._handleTagComplete,this)}var t=createjs.extend(e,createjs.TagRequest);t.load=function(){var e=createjs.proxy(this._handleStalled,this);this._stalledCallback=e;var t=createjs.proxy(this._handleProgress,this);this._handleProgress=t,this._tag.addEventListener("stalled",e),this._tag.addEventListener("progress",t),this._tag.addEventListener&&this._tag.addEventListener("canplaythrough",this._loadedHandler,!1),this.TagRequest_load()},t._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var e=this._tag;("loaded"==e.readyState||"complete"==e.readyState)&&this._handleTagComplete()},t._handleStalled=function(){},t._handleProgress=function(e){if(e&&!(e.loaded>0&&0==e.total)){var t=new createjs.ProgressEvent(e.loaded,e.total);this.dispatchEvent(t)}},t._clean=function(){this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.removeEventListener("stalled",this._stalledCallback),this._tag.removeEventListener("progress",this._progressCallback),this.TagRequest__clean()},createjs.MediaTagRequest=createjs.promote(e,"TagRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e){this.AbstractRequest_constructor(e),this._request=null,this._loadTimeout=null,this._xhrLevel=1,this._response=null,this._rawResponse=null,this._canceled=!1,this._handleLoadStartProxy=createjs.proxy(this._handleLoadStart,this),this._handleProgressProxy=createjs.proxy(this._handleProgress,this),this._handleAbortProxy=createjs.proxy(this._handleAbort,this),this._handleErrorProxy=createjs.proxy(this._handleError,this),this._handleTimeoutProxy=createjs.proxy(this._handleTimeout,this),this._handleLoadProxy=createjs.proxy(this._handleLoad,this),this._handleReadyStateChangeProxy=createjs.proxy(this._handleReadyStateChange,this),!this._createXHR(e)}var t=createjs.extend(e,createjs.AbstractRequest);e.ACTIVEX_VERSIONS=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],t.getResult=function(e){return e&&this._rawResponse?this._rawResponse:this._response},t.cancel=function(){this.canceled=!0,this._clean(),this._request.abort()},t.load=function(){if(null==this._request)return void this._handleError();null!=this._request.addEventListener?(this._request.addEventListener("loadstart",this._handleLoadStartProxy,!1),this._request.addEventListener("progress",this._handleProgressProxy,!1),this._request.addEventListener("abort",this._handleAbortProxy,!1),this._request.addEventListener("error",this._handleErrorProxy,!1),this._request.addEventListener("timeout",this._handleTimeoutProxy,!1),this._request.addEventListener("load",this._handleLoadProxy,!1),this._request.addEventListener("readystatechange",this._handleReadyStateChangeProxy,!1)):(this._request.onloadstart=this._handleLoadStartProxy,this._request.onprogress=this._handleProgressProxy,this._request.onabort=this._handleAbortProxy,this._request.onerror=this._handleErrorProxy,this._request.ontimeout=this._handleTimeoutProxy,this._request.onload=this._handleLoadProxy,this._request.onreadystatechange=this._handleReadyStateChangeProxy),1==this._xhrLevel&&(this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout));try{this._item.values&&this._item.method!=createjs.AbstractLoader.GET?this._item.method==createjs.AbstractLoader.POST&&this._request.send(createjs.RequestUtils.formatQueryString(this._item.values)):this._request.send()}catch(e){this.dispatchEvent(new createjs.ErrorEvent("XHR_SEND",null,e))}},t.setResponseType=function(e){"blob"===e&&(e=window.URL?"blob":"arraybuffer",this._responseType=e),this._request.responseType=e},t.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders instanceof Function?this._request.getAllResponseHeaders():null},t.getResponseHeader=function(e){return this._request.getResponseHeader instanceof Function?this._request.getResponseHeader(e):null},t._handleProgress=function(e){if(e&&!(e.loaded>0&&0==e.total)){var t=new createjs.ProgressEvent(e.loaded,e.total);this.dispatchEvent(t)}},t._handleLoadStart=function(){clearTimeout(this._loadTimeout),this.dispatchEvent("loadstart")},t._handleAbort=function(e){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("XHR_ABORTED",null,e))},t._handleError=function(e){this._clean(),this.dispatchEvent(new createjs.ErrorEvent(e.message))},t._handleReadyStateChange=function(){4==this._request.readyState&&this._handleLoad()},t._handleLoad=function(){if(!this.loaded){this.loaded=!0;var e=this._checkError();if(e)return void this._handleError(e);if(this._response=this._getResponse(),"arraybuffer"===this._responseType)try{this._response=new Blob([this._response])}catch(e){if(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,"TypeError"===e.name&&window.BlobBuilder){var t=new BlobBuilder;t.append(this._response),this._response=t.getBlob()}}this._clean(),this.dispatchEvent(new createjs.Event("complete"))}},t._handleTimeout=function(e){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_TIMEOUT",null,e))},t._checkError=function(){var e=parseInt(this._request.status);switch(e){case 404:case 0:return new Error(e)}return null},t._getResponse=function(){if(null!=this._response)return this._response;if(null!=this._request.response)return this._request.response;try{if(null!=this._request.responseText)return this._request.responseText}catch(e){}try{if(null!=this._request.responseXML)return this._request.responseXML}catch(e){}return null},t._createXHR=function(e){var t=createjs.RequestUtils.isCrossDomain(e),r={},i=null;if(window.XMLHttpRequest)i=new XMLHttpRequest,t&&void 0===i.withCredentials&&window.XDomainRequest&&(i=new XDomainRequest);else{for(var n=0,a=s.ACTIVEX_VERSIONS.length;a>n;n++){var o=s.ACTIVEX_VERSIONS[n];try{i=new ActiveXObject(o);break}catch(e){}}if(null==i)return!1}null==e.mimeType&&createjs.RequestUtils.isText(e.type)&&(e.mimeType="text/plain; charset=utf-8"),e.mimeType&&i.overrideMimeType&&i.overrideMimeType(e.mimeType),this._xhrLevel="string"==typeof i.responseType?2:1;var c=null;if(c=e.method==createjs.AbstractLoader.GET?createjs.RequestUtils.buildPath(e.src,e.values):e.src,i.open(e.method||createjs.AbstractLoader.GET,c,!0),t&&i instanceof XMLHttpRequest&&1==this._xhrLevel&&(r.Origin=location.origin),e.values&&e.method==createjs.AbstractLoader.POST&&(r["Content-Type"]="application/x-www-form-urlencoded"),t||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),e.headers)for(var l in e.headers)r[l]=e.headers[l];for(l in r)i.setRequestHeader(l,r[l]);return i instanceof XMLHttpRequest&&void 0!==e.withCredentials&&(i.withCredentials=e.withCredentials),this._request=i,!0},t._clean=function(){clearTimeout(this._loadTimeout),null!=this._request.removeEventListener?(this._request.removeEventListener("loadstart",this._handleLoadStartProxy),this._request.removeEventListener("progress",this._handleProgressProxy),this._request.removeEventListener("abort",this._handleAbortProxy),this._request.removeEventListener("error",this._handleErrorProxy),this._request.removeEventListener("timeout",this._handleTimeoutProxy),this._request.removeEventListener("load",this._handleLoadProxy),this._request.removeEventListener("readystatechange",this._handleReadyStateChangeProxy)):(this._request.onloadstart=null,this._request.onprogress=null,this._request.onabort=null,
this._request.onerror=null,this._request.ontimeout=null,this._request.onload=null,this._request.onreadystatechange=null)},t.toString=function(){return"[PreloadJS XHRRequest]"},createjs.XHRRequest=createjs.promote(e,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e,t,s){this.AbstractLoader_constructor(),this._plugins=[],this._typeCallbacks={},this._extensionCallbacks={},this.next=null,this.maintainScriptOrder=!0,this.stopOnError=!1,this._maxConnections=1,this._availableLoaders=[createjs.ImageLoader,createjs.JavaScriptLoader,createjs.CSSLoader,createjs.JSONLoader,createjs.JSONPLoader,createjs.SoundLoader,createjs.ManifestLoader,createjs.SpriteSheetLoader,createjs.XMLLoader,createjs.SVGLoader,createjs.BinaryLoader,createjs.VideoLoader,createjs.TextLoader],this._defaultLoaderLength=this._availableLoaders.length,this.init(e,t,s)}var t=createjs.extend(e,createjs.AbstractLoader),s=e;t.init=function(e,t,s){this.useXHR=!0,this.preferXHR=!0,this._preferXHR=!0,this.setPreferXHR(e),this._paused=!1,this._basePath=t,this._crossOrigin=s,this._loadStartWasDispatched=!1,this._currentlyLoadingScript=null,this._currentLoads=[],this._loadQueue=[],this._loadQueueBackup=[],this._loadItemsById={},this._loadItemsBySrc={},this._loadedResults={},this._loadedRawResults={},this._numItems=0,this._numItemsLoaded=0,this._scriptOrder=[],this._loadedScripts=[],this._lastProgress=NaN},s.loadTimeout=8e3,s.LOAD_TIMEOUT=0,s.BINARY=createjs.AbstractLoader.BINARY,s.CSS=createjs.AbstractLoader.CSS,s.IMAGE=createjs.AbstractLoader.IMAGE,s.JAVASCRIPT=createjs.AbstractLoader.JAVASCRIPT,s.JSON=createjs.AbstractLoader.JSON,s.JSONP=createjs.AbstractLoader.JSONP,s.MANIFEST=createjs.AbstractLoader.MANIFEST,s.SOUND=createjs.AbstractLoader.SOUND,s.VIDEO=createjs.AbstractLoader.VIDEO,s.SVG=createjs.AbstractLoader.SVG,s.TEXT=createjs.AbstractLoader.TEXT,s.XML=createjs.AbstractLoader.XML,s.POST=createjs.AbstractLoader.POST,s.GET=createjs.AbstractLoader.GET,t.registerLoader=function(e){if(!e||!e.canLoadItem)throw new Error("loader is of an incorrect type.");if(-1!=this._availableLoaders.indexOf(e))throw new Error("loader already exists.");this._availableLoaders.unshift(e)},t.unregisterLoader=function(e){var t=this._availableLoaders.indexOf(e);-1!=t&&t<this._defaultLoaderLength-1&&this._availableLoaders.splice(t,1)},t.setUseXHR=function(e){return this.setPreferXHR(e)},t.setPreferXHR=function(e){return this.preferXHR=0!=e&&null!=window.XMLHttpRequest,this.preferXHR},t.removeAll=function(){this.remove()},t.remove=function(e){var t=null;if(e&&!Array.isArray(e))t=[e];else if(e)t=e;else if(arguments.length>0)return;var s=!1;if(t){for(;t.length;){var r=t.pop(),i=this.getResult(r);for(n=this._loadQueue.length-1;n>=0;n--)if(a=this._loadQueue[n].getItem(),a.id==r||a.src==r){this._loadQueue.splice(n,1)[0].cancel();break}for(n=this._loadQueueBackup.length-1;n>=0;n--)if(a=this._loadQueueBackup[n].getItem(),a.id==r||a.src==r){this._loadQueueBackup.splice(n,1)[0].cancel();break}if(i)this._disposeItem(this.getItem(r));else for(var n=this._currentLoads.length-1;n>=0;n--){var a=this._currentLoads[n].getItem();if(a.id==r||a.src==r){this._currentLoads.splice(n,1)[0].cancel(),s=!0;break}}}s&&this._loadNext()}else{this.close();for(var o in this._loadItemsById)this._disposeItem(this._loadItemsById[o]);this.init(this.preferXHR,this._basePath)}},t.reset=function(){this.close();for(var e in this._loadItemsById)this._disposeItem(this._loadItemsById[e]);for(var t=[],s=0,r=this._loadQueueBackup.length;r>s;s++)t.push(this._loadQueueBackup[s].getItem());this.loadManifest(t,!1)},t.installPlugin=function(e){if(null!=e&&null!=e.getPreloadHandlers){this._plugins.push(e);var t=e.getPreloadHandlers();if(t.scope=e,null!=t.types)for(var s=0,r=t.types.length;r>s;s++)this._typeCallbacks[t.types[s]]=t;if(null!=t.extensions)for(s=0,r=t.extensions.length;r>s;s++)this._extensionCallbacks[t.extensions[s]]=t}},t.setMaxConnections=function(e){this._maxConnections=e,!this._paused&&this._loadQueue.length>0&&this._loadNext()},t.loadFile=function(e,t,s){if(null==e){var r=new createjs.ErrorEvent("PRELOAD_NO_FILE");return void this._sendError(r)}this._addItem(e,null,s),this.setPaused(t===!1)},t.loadManifest=function(e,t,r){var i=null,n=null;if(Array.isArray(e)){if(0==e.length){var a=new createjs.ErrorEvent("PRELOAD_MANIFEST_EMPTY");return void this._sendError(a)}i=e}else if("string"==typeof e)i=[{src:e,type:s.MANIFEST}];else{if("object"!=typeof e){var a=new createjs.ErrorEvent("PRELOAD_MANIFEST_NULL");return void this._sendError(a)}if(void 0!==e.src){if(null==e.type)e.type=s.MANIFEST;else if(e.type!=s.MANIFEST){var a=new createjs.ErrorEvent("PRELOAD_MANIFEST_TYPE");this._sendError(a)}i=[e]}else void 0!==e.manifest&&(i=e.manifest,n=e.path)}for(var o=0,c=i.length;c>o;o++)this._addItem(i[o],n,r);this.setPaused(t===!1)},t.load=function(){this.setPaused(!1)},t.getItem=function(e){return this._loadItemsById[e]||this._loadItemsBySrc[e]},t.getResult=function(e,t){var s=this._loadItemsById[e]||this._loadItemsBySrc[e];if(null==s)return null;var r=s.id;return t&&this._loadedRawResults[r]?this._loadedRawResults[r]:this._loadedResults[r]},t.getItems=function(e){var t=[];for(var s in this._loadItemsById){var r=this._loadItemsById[s],i=this.getResult(s);(e!==!0||null!=i)&&t.push({item:r,result:i,rawResult:this.getResult(s,!0)})}return t},t.setPaused=function(e){this._paused=e,this._paused||this._loadNext()},t.close=function(){for(;this._currentLoads.length;)this._currentLoads.pop().cancel();this._scriptOrder.length=0,this._loadedScripts.length=0,this.loadStartWasDispatched=!1,this._itemCount=0,this._lastProgress=NaN},t._addItem=function(e,t,s){var r=this._createLoadItem(e,t,s);if(null!=r){var i=this._createLoader(r);null!=i&&("plugins"in i&&(i.plugins=this._plugins),r._loader=i,this._loadQueue.push(i),this._loadQueueBackup.push(i),this._numItems++,this._updateProgress(),(this.maintainScriptOrder&&r.type==createjs.LoadQueue.JAVASCRIPT||r.maintainOrder===!0)&&(this._scriptOrder.push(r),this._loadedScripts.push(null)))}},t._createLoadItem=function(e,t,s){var r=createjs.LoadItem.create(e);if(null==r)return null;var i="",n=s||this._basePath;if(r.src instanceof Object){if(!r.type)return null;if(t){i=t;var a=createjs.RequestUtils.parseURI(t);null==n||a.absolute||a.relative||(i=n+i)}else null!=n&&(i=n)}else{var o=createjs.RequestUtils.parseURI(r.src);o.extension&&(r.ext=o.extension),null==r.type&&(r.type=createjs.RequestUtils.getTypeByExtension(r.ext));var c=r.src;if(!o.absolute&&!o.relative)if(t){i=t;var a=createjs.RequestUtils.parseURI(t);c=t+c,null==n||a.absolute||a.relative||(i=n+i)}else null!=n&&(i=n);r.src=i+r.src}r.path=i,(void 0===r.id||null===r.id||""===r.id)&&(r.id=c);var l=this._typeCallbacks[r.type]||this._extensionCallbacks[r.ext];if(l){var h=l.callback.call(l.scope,r,this);if(h===!1)return null;h===!0||null!=h&&(r._loader=h),o=createjs.RequestUtils.parseURI(r.src),null!=o.extension&&(r.ext=o.extension)}return this._loadItemsById[r.id]=r,this._loadItemsBySrc[r.src]=r,null==r.crossOrigin&&(r.crossOrigin=this._crossOrigin),r},t._createLoader=function(e){if(null!=e._loader)return e._loader;for(var t=this.preferXHR,s=0;s<this._availableLoaders.length;s++){var r=this._availableLoaders[s];if(r&&r.canLoadItem(e))return new r(e,t)}return null},t._loadNext=function(){if(!this._paused){this._loadStartWasDispatched||(this._sendLoadStart(),this._loadStartWasDispatched=!0),this._numItems==this._numItemsLoaded?(this.loaded=!0,this._sendComplete(),this.next&&this.next.load&&this.next.load()):this.loaded=!1;for(var e=0;e<this._loadQueue.length&&!(this._currentLoads.length>=this._maxConnections);e++){var t=this._loadQueue[e];this._canStartLoad(t)&&(this._loadQueue.splice(e,1),e--,this._loadItem(t))}}},t._loadItem=function(e){e.on("fileload",this._handleFileLoad,this),e.on("progress",this._handleProgress,this),e.on("complete",this._handleFileComplete,this),e.on("error",this._handleError,this),e.on("fileerror",this._handleFileError,this),this._currentLoads.push(e),this._sendFileStart(e.getItem()),e.load()},t._handleFileLoad=function(e){e.target=null,this.dispatchEvent(e)},t._handleFileError=function(e){var t=new createjs.ErrorEvent("FILE_LOAD_ERROR",null,e.item);this._sendError(t)},t._handleError=function(e){var t=e.target;this._numItemsLoaded++,this._finishOrderedItem(t,!0),this._updateProgress();var s=new createjs.ErrorEvent("FILE_LOAD_ERROR",null,t.getItem());this._sendError(s),this.stopOnError?this.setPaused(!0):(this._removeLoadItem(t),this._cleanLoadItem(t),this._loadNext())},t._handleFileComplete=function(e){var t=e.target,s=t.getItem(),r=t.getResult();this._loadedResults[s.id]=r;var i=t.getResult(!0);null!=i&&i!==r&&(this._loadedRawResults[s.id]=i),this._saveLoadedItems(t),this._removeLoadItem(t),this._finishOrderedItem(t)||this._processFinishedLoad(s,t),this._cleanLoadItem(t)},t._saveLoadedItems=function(e){var t=e.getLoadedItems();if(null!==t)for(var s=0;s<t.length;s++){var r=t[s].item;this._loadItemsBySrc[r.src]=r,this._loadItemsById[r.id]=r,this._loadedResults[r.id]=t[s].result,this._loadedRawResults[r.id]=t[s].rawResult}},t._finishOrderedItem=function(e,t){var s=e.getItem();if(this.maintainScriptOrder&&s.type==createjs.LoadQueue.JAVASCRIPT||s.maintainOrder){e instanceof createjs.JavaScriptLoader&&(this._currentlyLoadingScript=!1);var r=createjs.indexOf(this._scriptOrder,s);return-1!=r&&(this._loadedScripts[r]=t===!0||s,this._checkScriptLoadOrder(),!0)}return!1},t._checkScriptLoadOrder=function(){for(var e=this._loadedScripts.length,t=0;e>t;t++){var s=this._loadedScripts[t];if(null===s)break;if(s!==!0){var r=this._loadedResults[s.id];s.type==createjs.LoadQueue.JAVASCRIPT&&createjs.DomUtils.appendToHead(r);var i=s._loader;this._processFinishedLoad(s,i),this._loadedScripts[t]=!0}}},t._processFinishedLoad=function(e,t){if(this._numItemsLoaded++,!this.maintainScriptOrder&&e.type==createjs.LoadQueue.JAVASCRIPT){var s=t.getTag();createjs.DomUtils.appendToHead(s)}this._updateProgress(),this._sendFileComplete(e,t),this._loadNext()},t._canStartLoad=function(e){if(!this.maintainScriptOrder||e.preferXHR)return!0;var t=e.getItem();if(t.type!=createjs.LoadQueue.JAVASCRIPT)return!0;if(this._currentlyLoadingScript)return!1;for(var s=this._scriptOrder.indexOf(t),r=0;s>r;){var i=this._loadedScripts[r];if(null==i)return!1;r++}return this._currentlyLoadingScript=!0,!0},t._removeLoadItem=function(e){for(var t=this._currentLoads.length,s=0;t>s;s++)if(this._currentLoads[s]==e){this._currentLoads.splice(s,1);break}},t._cleanLoadItem=function(e){var t=e.getItem();t&&delete t._loader},t._handleProgress=function(e){var t=e.target;this._sendFileProgress(t.getItem(),t.progress),this._updateProgress()},t._updateProgress=function(){var e=this._numItemsLoaded/this._numItems,t=this._numItems-this._numItemsLoaded;if(t>0){for(var s=0,r=0,i=this._currentLoads.length;i>r;r++)s+=this._currentLoads[r].progress;e+=s/t*(t/this._numItems)}this._lastProgress!=e&&(this._sendProgress(e),this._lastProgress=e)},t._disposeItem=function(e){delete this._loadedResults[e.id],delete this._loadedRawResults[e.id],delete this._loadItemsById[e.id],delete this._loadItemsBySrc[e.src]},t._sendFileProgress=function(e,t){if(!this._isCanceled()&&!this._paused&&this.hasEventListener("fileprogress")){var s=new createjs.Event("fileprogress");s.progress=t,s.loaded=t,s.total=1,s.item=e,this.dispatchEvent(s)}},t._sendFileComplete=function(e,t){if(!this._isCanceled()&&!this._paused){var s=new createjs.Event("fileload");s.loader=t,s.item=e,s.result=this._loadedResults[e.id],s.rawResult=this._loadedRawResults[e.id],e.completeHandler&&e.completeHandler(s),this.hasEventListener("fileload")&&this.dispatchEvent(s)}},t._sendFileStart=function(e){var t=new createjs.Event("filestart");t.item=e,this.hasEventListener("filestart")&&this.dispatchEvent(t)},t.toString=function(){return"[PreloadJS LoadQueue]"},createjs.LoadQueue=createjs.promote(e,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e){this.AbstractLoader_constructor(e,!0,createjs.AbstractLoader.TEXT)}var t=(createjs.extend(e,createjs.AbstractLoader),e);t.canLoadItem=function(e){return e.type==createjs.AbstractLoader.TEXT},createjs.TextLoader=createjs.promote(e,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e){this.AbstractLoader_constructor(e,!0,createjs.AbstractLoader.BINARY),this.on("initialize",this._updateXHR,this)}var t=createjs.extend(e,createjs.AbstractLoader),s=e;s.canLoadItem=function(e){return e.type==createjs.AbstractLoader.BINARY},t._updateXHR=function(e){e.loader.setResponseType("arraybuffer")},createjs.BinaryLoader=createjs.promote(e,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e,t){this.AbstractLoader_constructor(e,t,createjs.AbstractLoader.CSS),this.resultFormatter=this._formatResult,this._tagSrcAttribute="href",this._tag=document.createElement(t?"style":"link"),this._tag.rel="stylesheet",this._tag.type="text/css"}var t=createjs.extend(e,createjs.AbstractLoader),s=e;s.canLoadItem=function(e){return e.type==createjs.AbstractLoader.CSS},t._formatResult=function(e){if(this._preferXHR){var t=e.getTag();if(t.styleSheet)t.styleSheet.cssText=e.getResult(!0);else{var s=document.createTextNode(e.getResult(!0));t.appendChild(s)}}else t=this._tag;return createjs.DomUtils.appendToHead(t),t},createjs.CSSLoader=createjs.promote(e,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e,t){this.AbstractLoader_constructor(e,t,createjs.AbstractLoader.IMAGE),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",createjs.RequestUtils.isImageTag(e)?this._tag=e:createjs.RequestUtils.isImageTag(e.src)?this._tag=e.src:createjs.RequestUtils.isImageTag(e.tag)&&(this._tag=e.tag),null!=this._tag?this._preferXHR=!1:this._tag=document.createElement("img"),this.on("initialize",this._updateXHR,this)}var t=createjs.extend(e,createjs.AbstractLoader),s=e;s.canLoadItem=function(e){return e.type==createjs.AbstractLoader.IMAGE},t.load=function(){if(""!=this._tag.src&&this._tag.complete)return void this._sendComplete();var e=this._item.crossOrigin;1==e&&(e="Anonymous"),null==e||createjs.RequestUtils.isLocal(this._item.src)||(this._tag.crossOrigin=e),this.AbstractLoader_load()},t._updateXHR=function(e){e.loader.mimeType="text/plain; charset=x-user-defined-binary",e.loader.setResponseType&&e.loader.setResponseType("blob")},t._formatResult=function(){return this._formatImage},t._formatImage=function(e,t){var s=this._tag,r=window.URL||window.webkitURL;if(this._preferXHR)if(r){var i=r.createObjectURL(this.getResult(!0));s.src=i,s.addEventListener("load",this._cleanUpURL,!1),s.addEventListener("error",this._cleanUpURL,!1)}else s.src=this._item.src;s.complete?e(s):(s.onload=createjs.proxy(function(){e(this._tag)},this),s.onerror=createjs.proxy(function(){t(_this._tag)},this))},t._cleanUpURL=function(e){var t=window.URL||window.webkitURL;t.revokeObjectURL(e.target.src)},createjs.ImageLoader=createjs.promote(e,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e,t){this.AbstractLoader_constructor(e,t,createjs.AbstractLoader.JAVASCRIPT),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",this.setTag(document.createElement("script"))}var t=createjs.extend(e,createjs.AbstractLoader),s=e;s.canLoadItem=function(e){return e.type==createjs.AbstractLoader.JAVASCRIPT},t._formatResult=function(e){var t=e.getTag();return this._preferXHR&&(t.text=e.getResult(!0)),t},createjs.JavaScriptLoader=createjs.promote(e,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e){this.AbstractLoader_constructor(e,!0,createjs.AbstractLoader.JSON),this.resultFormatter=this._formatResult}var t=createjs.extend(e,createjs.AbstractLoader),s=e;s.canLoadItem=function(e){return e.type==createjs.AbstractLoader.JSON},t._formatResult=function(e){var t=null;try{t=createjs.DataUtils.parseJSON(e.getResult(!0))}catch(e){var s=new createjs.ErrorEvent("JSON_FORMAT",null,e);return this._sendError(s),e}return t},createjs.JSONLoader=createjs.promote(e,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e){this.AbstractLoader_constructor(e,!1,createjs.AbstractLoader.JSONP),this.setTag(document.createElement("script")),this.getTag().type="text/javascript"}var t=createjs.extend(e,createjs.AbstractLoader),s=e;s.canLoadItem=function(e){return e.type==createjs.AbstractLoader.JSONP},t.cancel=function(){this.AbstractLoader_cancel(),this._dispose()},t.load=function(){if(null==this._item.callback)throw new Error("callback is required for loading JSONP requests.");if(null!=window[this._item.callback])throw new Error("JSONP callback '"+this._item.callback+"' already exists on window. You need to specify a different callback or re-name the current one.");window[this._item.callback]=createjs.proxy(this._handleLoad,this),window.document.body.appendChild(this._tag),this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag.src=this._item.src},t._handleLoad=function(e){this._result=this._rawResult=e,this._sendComplete(),this._dispose()},t._handleTimeout=function(){this._dispose(),this.dispatchEvent(new createjs.ErrorEvent("timeout"))},t._dispose=function(){window.document.body.removeChild(this._tag),delete window[this._item.callback],clearTimeout(this._loadTimeout)},createjs.JSONPLoader=createjs.promote(e,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e){this.AbstractLoader_constructor(e,null,createjs.AbstractLoader.MANIFEST),this.plugins=null,this._manifestQueue=null}var t=createjs.extend(e,createjs.AbstractLoader),s=e;s.MANIFEST_PROGRESS=.25,s.canLoadItem=function(e){return e.type==createjs.AbstractLoader.MANIFEST},t.load=function(){this.AbstractLoader_load()},t._createRequest=function(){var e=this._item.callback;this._request=null!=e?new createjs.JSONPLoader(this._item):new createjs.JSONLoader(this._item)},t.handleEvent=function(e){switch(e.type){case"complete":return this._rawResult=e.target.getResult(!0),this._result=e.target.getResult(),this._sendProgress(s.MANIFEST_PROGRESS),void this._loadManifest(this._result);case"progress":return e.loaded*=s.MANIFEST_PROGRESS,this.progress=e.loaded/e.total,(isNaN(this.progress)||1/0==this.progress)&&(this.progress=0),void this._sendProgress(e)}this.AbstractLoader_handleEvent(e)},t.destroy=function(){this.AbstractLoader_destroy(),this._manifestQueue.close()},t._loadManifest=function(e){if(e&&e.manifest){var t=this._manifestQueue=new createjs.LoadQueue;t.on("fileload",this._handleManifestFileLoad,this),t.on("progress",this._handleManifestProgress,this),t.on("complete",this._handleManifestComplete,this,!0),t.on("error",this._handleManifestError,this,!0);for(var s=0,r=this.plugins.length;r>s;s++)t.installPlugin(this.plugins[s]);t.loadManifest(e)}else this._sendComplete()},t._handleManifestFileLoad=function(e){e.target=null,this.dispatchEvent(e)},t._handleManifestComplete=function(){this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},t._handleManifestProgress=function(e){this.progress=e.progress*(1-s.MANIFEST_PROGRESS)+s.MANIFEST_PROGRESS,this._sendProgress(this.progress)},t._handleManifestError=function(e){var t=new createjs.Event("fileerror");t.item=e.data,this.dispatchEvent(t)},createjs.ManifestLoader=createjs.promote(e,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e,t){this.AbstractMediaLoader_constructor(e,t,createjs.AbstractLoader.SOUND),createjs.RequestUtils.isAudioTag(e)?this._tag=e:createjs.RequestUtils.isAudioTag(e.src)?this._tag=e:createjs.RequestUtils.isAudioTag(e.tag)&&(this._tag=createjs.RequestUtils.isAudioTag(e)?e:e.src),null!=this._tag&&(this._preferXHR=!1)}var t=createjs.extend(e,createjs.AbstractMediaLoader),s=e;s.canLoadItem=function(e){return e.type==createjs.AbstractLoader.SOUND},t._createTag=function(e){var t=document.createElement("audio");return t.autoplay=!1,t.preload="none",t.src=e,t},createjs.SoundLoader=createjs.promote(e,"AbstractMediaLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e,t){this.AbstractMediaLoader_constructor(e,t,createjs.AbstractLoader.VIDEO),createjs.RequestUtils.isVideoTag(e)||createjs.RequestUtils.isVideoTag(e.src)?(this.setTag(createjs.RequestUtils.isVideoTag(e)?e:e.src),this._preferXHR=!1):this.setTag(this._createTag())}var t=createjs.extend(e,createjs.AbstractMediaLoader),s=e;t._createTag=function(){return document.createElement("video")},s.canLoadItem=function(e){return e.type==createjs.AbstractLoader.VIDEO},createjs.VideoLoader=createjs.promote(e,"AbstractMediaLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e,t){this.AbstractLoader_constructor(e,t,createjs.AbstractLoader.SPRITESHEET),this._manifestQueue=null}var t=createjs.extend(e,createjs.AbstractLoader),s=e;s.SPRITESHEET_PROGRESS=.25,s.canLoadItem=function(e){return e.type==createjs.AbstractLoader.SPRITESHEET},t.destroy=function(){this.AbstractLoader_destroy,this._manifestQueue.close()},t._createRequest=function(){var e=this._item.callback;this._request=null!=e?new createjs.JSONPLoader(this._item):new createjs.JSONLoader(this._item)},t.handleEvent=function(e){switch(e.type){case"complete":return this._rawResult=e.target.getResult(!0),this._result=e.target.getResult(),this._sendProgress(s.SPRITESHEET_PROGRESS),void this._loadManifest(this._result);case"progress":return e.loaded*=s.SPRITESHEET_PROGRESS,this.progress=e.loaded/e.total,(isNaN(this.progress)||1/0==this.progress)&&(this.progress=0),void this._sendProgress(e)}this.AbstractLoader_handleEvent(e)},t._loadManifest=function(e){if(e&&e.images){var t=this._manifestQueue=new createjs.LoadQueue(this._preferXHR,this._item.path,this._item.crossOrigin);t.on("complete",this._handleManifestComplete,this,!0),t.on("fileload",this._handleManifestFileLoad,this),t.on("progress",this._handleManifestProgress,this),t.on("error",this._handleManifestError,this,!0),t.loadManifest(e.images)}},t._handleManifestFileLoad=function(e){var t=e.result;if(null!=t){var s=this.getResult().images,r=s.indexOf(e.item.src);s[r]=t}},t._handleManifestComplete=function(){this._result=new createjs.SpriteSheet(this._result),this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},t._handleManifestProgress=function(e){this.progress=e.progress*(1-s.SPRITESHEET_PROGRESS)+s.SPRITESHEET_PROGRESS,this._sendProgress(this.progress)},t._handleManifestError=function(e){var t=new createjs.Event("fileerror");t.item=e.data,this.dispatchEvent(t)},createjs.SpriteSheetLoader=createjs.promote(e,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e,t){this.AbstractLoader_constructor(e,t,createjs.AbstractLoader.SVG),this.resultFormatter=this._formatResult,this._tagSrcAttribute="data",t?this.setTag(document.createElement("svg")):(this.setTag(document.createElement("object")),this.getTag().type="image/svg+xml")}var t=createjs.extend(e,createjs.AbstractLoader),s=e;s.canLoadItem=function(e){return e.type==createjs.AbstractLoader.SVG},t._formatResult=function(e){var t=createjs.DataUtils.parseXML(e.getResult(!0),"text/xml"),s=e.getTag();return!this._preferXHR&&document.body.contains(s)&&document.body.removeChild(s),null!=t.documentElement?(s.appendChild(t.documentElement),s.style.visibility="visible",s):t},createjs.SVGLoader=createjs.promote(e,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e){this.AbstractLoader_constructor(e,!0,createjs.AbstractLoader.XML),this.resultFormatter=this._formatResult}var t=createjs.extend(e,createjs.AbstractLoader),s=e;s.canLoadItem=function(e){return e.type==createjs.AbstractLoader.XML},t._formatResult=function(e){return createjs.DataUtils.parseXML(e.getResult(!0),"text/xml")},createjs.XMLLoader=createjs.promote(e,"AbstractLoader")}(),Date.now||(Date.now=function(){return(new Date).getTime()}),function(){"use strict";for(var e=["webkit","moz"],t=0;t<e.length&&!window.requestAnimationFrame;++t){var s=e[t];window.requestAnimationFrame=window[s+"RequestAnimationFrame"],window.cancelAnimationFrame=window[s+"CancelAnimationFrame"]||window[s+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var r=0;window.requestAnimationFrame=function(e){var t=Date.now(),s=Math.max(r+16,t);return setTimeout(function(){e(r=s)},s-t)},window.cancelAnimationFrame=clearTimeout}}(),function(e){e.snowfall=function(t,s){function r(r,i,n,c){this.x=r,this.y=i,this.size=n,this.speed=c,this.step=0,this.stepSize=o(1,10)/100,s.collection&&(this.target=p[o(0,p.length-1)]);var d=null;s.image?(d=document.createElement("img"),d.src=s.image):(d=document.createElement("div"),e(d).css({background:s.flakeColor})),e(d).attr({class:"snowfall-flakes"}).css({width:this.size,height:this.size,position:s.flakePosition,top:this.y,left:this.x,fontSize:0,zIndex:s.flakeIndex}),e(t).get(0).tagName===e(document).get(0).tagName?(e("body").append(e(d)),t=e("body")):e(t).append(e(d)),this.element=d,this.update=function(){if(this.y+=this.speed,this.y>l-(this.size+6)&&this.reset(),this.element.style.top=this.y+"px",this.element.style.left=this.x+"px",this.step+=this.stepSize,L===!1?this.x+=Math.cos(this.step):this.x+=L+Math.cos(this.step),s.collection&&this.x>this.target.x&&this.x<this.target.width+this.target.x&&this.y>this.target.y&&this.y<this.target.height+this.target.y){var e=this.target.element.getContext("2d"),t=this.x-this.target.x,r=this.y-this.target.y,i=this.target.colData;if(void 0!==i[parseInt(t)][parseInt(r+this.speed+this.size)]||r+this.speed+this.size>this.target.height)if(r+this.speed+this.size>this.target.height){for(;r+this.speed+this.size>this.target.height&&this.speed>0;)this.speed*=.5;e.fillStyle=a.flakeColor,void 0==i[parseInt(t)][parseInt(r+this.speed+this.size)]?(i[parseInt(t)][parseInt(r+this.speed+this.size)]=1,e.fillRect(t,r+this.speed+this.size,this.size,this.size)):(i[parseInt(t)][parseInt(r+this.speed)]=1,e.fillRect(t,r+this.speed,this.size,this.size)),this.reset()}else this.speed=1,this.stepSize=0,parseInt(t)+1<this.target.width&&void 0==i[parseInt(t)+1][parseInt(r)+1]?this.x++:parseInt(t)-1>0&&void 0==i[parseInt(t)-1][parseInt(r)+1]?this.x--:(e.fillStyle=a.flakeColor,e.fillRect(t,r,this.size,this.size),i[parseInt(t)][parseInt(r)]=1,this.reset())}(this.x+this.size>h-u||this.x<u)&&this.reset()},this.reset=function(){this.y=0,this.x=o(u,h-u),this.stepSize=o(1,10)/100,this.size=o(100*s.minSize,100*s.maxSize)/100,this.element.style.width=this.size+"px",this.element.style.height=this.size+"px",this.speed=o(s.minSpeed,s.maxSpeed)}}function i(){for(c=0;c<n.length;c+=1)n[c].update();d=requestAnimationFrame(function(){i()})}var n=[],a={flakeCount:35,flakeColor:"#ffffff",flakePosition:"absolute",flakeIndex:999999,minSize:1,maxSize:2,minSpeed:1,maxSpeed:5,round:!1,shadow:!1,collection:!1,collectionHeight:40,deviceorientation:!1},s=e.extend(a,s),o=function(e,t){return Math.round(e+Math.random()*(t-e))};e(t).data("snowfall",this);var c=0,l=e(t).height(),h=e(t).width(),u=0,d=0;if(s.collection!==!1){var f=document.createElement("canvas");if(f.getContext&&f.getContext("2d"))for(var p=[],g=e(s.collection),_=s.collectionHeight,c=0;c<g.length;c++){var m=g[c].getBoundingClientRect(),v=e("<canvas/>",{class:"snowfall-canvas"}),b=[];if(m.top-_>0){e("body").append(v),v.css({position:s.flakePosition,left:m.left+"px",top:m.top-_+"px"}).prop({width:m.width,height:_});for(var y=0;y<m.width;y++)b[y]=[];p.push({element:v.get(0),x:m.left,y:m.top-_,width:m.width,height:_,colData:b})}}else s.collection=!1}for(e(t).get(0).tagName===e(document).get(0).tagName&&(u=25),e(window).bind("resize",function(){l=e(t)[0].clientHeight,h=e(t)[0].offsetWidth}),c=0;c<s.flakeCount;c+=1)n.push(new r(o(u,h-u),o(0,l),o(100*s.minSize,100*s.maxSize)/100,o(s.minSpeed,s.maxSpeed)));s.round&&e(".snowfall-flakes").css({"-moz-border-radius":s.maxSize,"-webkit-border-radius":s.maxSize,"border-radius":s.maxSize}),s.shadow&&e(".snowfall-flakes").css({"-moz-box-shadow":"1px 1px 1px #555","-webkit-box-shadow":"1px 1px 1px #555","box-shadow":"1px 1px 1px #555"});var L=!1;s.deviceorientation&&e(window).bind("deviceorientation",function(e){L=.1*e.originalEvent.gamma}),i(),this.clear=function(){e(".snowfall-canvas").remove(),e(t).children(".snowfall-flakes").remove(),cancelAnimationFrame(d)}},e.fn.snowfall=function(t){return"object"==typeof t||void 0==t?this.each(function(s){new e.snowfall(this,t)}):"string"==typeof t?this.each(function(t){var s=e(this).data("snowfall");s&&s.clear()}):void 0}}(jQuery);var NovelScript={},ns=NovelScript;ns.novelScript="hina",ns.version=.1,ns.effect={},ns.dev={},ns.controls={},ns.default={},ns.data={},ns.$frame=$("body"),ns.preload=function(e,t,s,r){t=t||"";var i=$.Deferred(),n=new createjs.LoadQueue;s&&n.on("fileload",s),n.on("complete",function(){i.resolve(),r&&r()});for(var a=0;a<e.length;a++)n.loadFile(t+e[a]);return i.promise()},ns.loadingbar=function(e,t,s){var r=ns.controls.theme;t=t||"";var i=$("<div></div>"),n=$("<div></div>").appendTo(i);r.loadingbarStyle?i.css(r.loadingbarStyle):i.css({width:"100px",height:"10px",border:"2px solid black","background-color":"black"}),r.loadingbarInterneStyle?n.css(r.loadingbarInterneStyle):n.css({width:0,height:"inherit","background-color":"white"});var a=i.width()/e.length,o=function(){n.width(n.width()+a)};return ns.preload(e,t,o,function(){ns.$frame.html(""),s&&s()}),i},ns.typer=function(){var e={};return e.given=function(e,t,s){e.append(t),(s=s||function(){return 0})()},e.typing=function(e,t,s,r){t=" "+t,s=s||100,r=r||function(){return 0};var i=function(e,t,r){e.append(t.shift()).delay(s).queue(function(){0===t.length?r():i(e,t,r),$(this).dequeue()})};i(e,t.split(""),r)},e.flush=function(e,t,s,r){t=" "+t,s=s||10,r=r||function(){return 0};var i=function(e,t,r){e.append($("<span></span>").html(t.shift()).fadeIn(s)).delay(s).queue(function(){0===t.length?r():i(e,t,r),$(this).dequeue()})};i(e,t.split(""),r)},e}(),ns.store=function(){var e={};return e.infolocal={},localStorage.nsStorageLocal?e.infolocal=JSON.parse(localStorage.nsStorageLocal):localStorage.nsStorageLocal=JSON.stringify(e.infolocal),e.infosession={},sessionStorage.nsStorageSession?e.infosession=JSON.parse(sessionStorage.nsStorageSession):sessionStorage.nsStorageSession=JSON.stringify(e.infosession),e.save=function(){localStorage.nsStorageLocal=JSON.stringify(e.infolocal),sessionStorage.nsStorageSession=JSON.stringify(e.infosession)},e.local=function(t,s){return void 0===s?e.infolocal[t]:(e.infolocal[t]=s,void e.save())},e.session=function(t,s){return void 0===s?e.infosession[t]:(e.infosession[t]=s,void e.save())},e.existLocal=function(t,s){return void 0===e.infolocal[t]&&(e.local(t,s),e.save()),e.infolocal(t)},e.existSession=function(t,s){return void 0===e.infosession[t]&&(e.session(t,s),e.save()),e.session(t)},e.clear=function(t){t=t||"local","local"==t?e.infolocal={}:e.infosession={},e.save()},e}(),ns.diapo=function(e,t,s,r,i,n){var a={};a.originBgColor=t.css("background-color");var o=function(e){return!e.jquery&&("jpg"==e.slice(-3)||"png"==e.slice(-3))};return a.$slide=$("<div></div>").hide().css({width:"100%","text-align":"center",color:"white","font-size":"300%"}),a.slideRec=function(e,t){if(e.length){var s=e[0];a.$slide.html(function(){return o(s)?$("<img />").attr("src",s):s}());var i=a.$slide.width();a.$slide.align("full"),a.$slide.width(i),a.$slide.fadeIn(r,function(){a.$slide.fadeOut(r,function(){a.slideRec(e.slice(1),t)})})}else a.recover(t)},a.slideIter=function(e,t){var s=function(t){var s=e[t];a.$slide.html(function(){return o(s)?$("<img />").attr("src",s):s}());var i=a.$slide.width();a.$slide.align("full"),a.$slide.width(i),a.$slide.fadeIn(r,function(){a.$slide.delay(2e3).fadeOut(1e3)})},i=function(){var t=0;return function(){s(t),t++,t>=e.length&&(t=0,n&&clearInterval(l));
}},c=i();setTimeout(c,0);var l=setInterval(c,3*r)},a.recover=function(e){t.children().show(),t.css("background-color",a.originBgColor),a.$slide.remove(),e()},a.execute=function(r){t.children().hide(),r=r||function(){return 0},t.append(a.$slide),a.$slide.align("full"),t.css("background-color",s),i?a.slideIter(e,r):a.slideRec(e,r)},a},ns.init=function(e,t,s){if(ns.$deferred=$.Deferred(),!e)throw"failed to load script data.";ns.data=e,ns.$frame=t||$("body"),ns.dp=ns.initDp(ns.data),ns.importState(ns.getStoredState()),void 0!==ns.state.state.round&&null!==ns.state.state.round||ns.initState(),ns.initTheme({width:ns.$frame.width(),height:ns.$frame.height()}),ns.initControls(s),ns.relation=ns.initRelation();var r=$.extend({},ns.controls.theme);ns.frame(ns.themes.default),ns.frame(r),ns.stage.$main.appendTo(ns.$frame),ns.slides=ns.slide(),ns.resource=ns.initResource(s),ns.merge=ns.initMerge(),ns.director(),ns.merge.listNonDistrib();var i=["anzu.jpg","anzu2.jpg","anzu_b.png","anzu_l.png","anzu_n.png","classroom.jpg","koharu.jpg","otome1.png","otome2.png","otome3.png","restaurant.jpg","room.jpg","sf.png","yume1.png","yume2.png","yume3.png"],n=ns.loadingbar(i,"tmp/e/",function(){ns.stage.$main.appendTo(ns.$frame),ns.slides=ns.slide(),ns.start()});ns.$frame.children().hide(0,function(){n.appendTo(ns.$frame).align("full")})},ns.default.state={meta:{nsversion:.1,idkey:"Lixia: the intro of summer"},timestamp:"2016-02-14 15:20:00",state:{round:null,script:"id01",position:0},stack:{speaker:null,dialogue:"",cg:[],bg:0,bgm:0}},ns.default.setting={theme:"hina"},ns.default.dialogueDisplay=ns.typer.flush,ns.initDp=function(e){var t={};return t.get=function(t,s){return void 0===s?e[t]:e[t][s]},t.getFromState=function(){return t.get(ns.state.state.script,ns.state.state.position)},t.stackFix=function(e,s){var r=t.get(e,s);if(0==s)return r;var i=function(e){var t=[];if(e.figure){for(var s=0;s<e.figure.length;s++)if(""===e.figure[s]||0===e.figure[s]){t.push("figure");break}}else t.push("figure");return e.cg||t.push("cg"),e.bg||t.push("bg"),e.bgm||t.push("bgm"),!!t.length&&t},n=i(r);if(!n)return r;var a=function(){for(var i=[],n=0;n<=s;n++){var a=t.get(e,n).figure;if(a)for(var o=0;o<a.length;o++)""!=a[o]&&(i[o]=a[o]);var c=t.get(e,n).cg;c&&(r.cg=c);var l=t.get(e,n).bg;l&&(r.bg=l);var h=t.get(e,n).bgm;l&&(r.bgm=h)}var u=[];for(o=0;o<i.length;o++)0!==i[o]&&"0"!==i[o]&&u.push(i[o]);r.figure=u};return a(),r},t.resourceCollector=function(e){e=e||ns.data;var t={};t.images=[],t.audios=[];for(var s=Object.keys(e),r=0;r<s.length;r++)for(var i=e[Object.keys[e][r]],n=0;n<i.length;n++){for(var a=0;a<i[n].figure.length;a++){var o=i[n].figure[a];o&&!t.images.indexOf(o)&&t.images.push(o)}var c=i[n].cg;c&&!t.images.indexOf(c)&&t.images.push(c);var l=i[n].bg;l&&!t.images.indexOf(l)&&t.images.push(l);var h=i[n].bgm;h&&!t.audios.indexOf(h)&&t.audios.push(h)}return t},t.firstScript=function(){return e[Object.keys(e)[0]]},t.firstScriptName=function(){return Object.keys(e)[0]},t.throughout=function(t){for(var s=Object.keys(e),r=0;r<s.length;r++)for(var i=e[s[r]],n=0;n<i.length;n++)t(i[n])},t},ns.dp={},ns.initResource=function(e){var t={};return t.images={},t.audios={},t.get=function(t,s){switch(t){case"figure":return $("<img />").attr("src",e.path.figure+s);case"cg":return e.path.cg+s;case"bg":return e.path.bg+s;case"bgm":return $("<audio></audio>").attr("src",e.path.bgm+s);default:throw"No specified type "+t}},t},ns.resource={},ns.resource.images={},ns.resource.audios={},ns.loadResource=function(){var e=$.Deferred(),t=ns.controls.images,s=ns.controls.audios;return $.when(ns.preloadImage(t,ns.resource.images)).done(function(){$.when(ns.preloadAudio(s,ns.resource.audios)).done(function(){e.resolve()}).fail(function(){throw"Audio preloading failed."})}).fail(function(){throw"Images preloading failed"}),e.promise()},ns.start=function(e,t){var s=ns.dp,r=ns.slides;e=e||s.firstScriptName(),t=t||0,r.changeStack(e,t),r.move()},ns.initRelation=function(){for(var e=ns.controls.relation,t=Object.keys(ns.data),s=0;s<t.length-1;s++)Object.keys(e).indexOf(t[s])==-1&&(e[t[s]]=[{condition:!0,child:t[s+1],position:0}]);return e[t[s]]=null,e},ns.relation={},ns.state={},ns.getStoredState=function(e){return ns.store.local("nsstate")},ns.storeState=function(){ns.store.local("nsstate",ns.state)},ns.importState=function(e){ns.state=ns.controls.statePassable(e)||ns.default.state},ns.initState=function(){ns.state.state.round=0,ns.state.state.script=Object.keys(ns.data)[0],ns.state.stack=ns.data[ns.state.state.script][0],ns.storeState()},ns.dev.statExample={meta:{nsversion:.1,idkey:"Lixia: the intro of summer"},timestamp:"2016-02-14 15:20:00",state:{round:null,dearness:{},script:"id01",position:0},stack:{speaker:null,dialogue:"",cg:[],bg:0,bgm:0}},ns.initTheme=function(e){e||(e={}),e.width||(e.width=ns.$frame.width()),e.height||(e.height=ns.$frame.height()),ns.themes.default={};var t=function(){var t={};t.mainstageStyle={width:e.width,height:e.height,"background-color":"#f3f3f3","background-size":e.width+"px "+e.height+"px",position:"relative","font-family":"YouYuan, ZhunYuan, Microsoft YaHei UI, Microsoft Yahei, "},t.figureStyle={width:e.width,position:"absolute",bottom:0,"text-align":"center"},t.figureImageStyle={height:.8*e.height},t.contentStyle={width:.7*e.width,height:e.height/4,position:"absolute",bottom:0},t.dialogueStyle={width:"inherit",height:"inherit","background-color":"gray",opacity:.4},t.novelMode=!1;var s=t.contentStyle.width,r=t.contentStyle.height;t.contentStyle.left=(e.width-s)/2,t.speakerStyle={"background-color":"gray",position:"absolute",left:0,top:0},t.dialStyle={"font-size":"150%",position:"absolute",left:s/8,top:r/5},t.mergeStyle={width:.3*e.width,position:"absolute",top:.25*e.height};var i=t.mergeStyle.width;return t.mergeStyle.left=(e.width-i)/2,t.choiceStyle={width:"inherit",height:"45px","background-color":"gray","font-size":"150%",padding:"5px","margin-bottom":"10px","text-align":"center"},t.choiceStyle["line-height"]=t.choiceStyle.height,t};ns.themes.default=t(),ns.themes.hina=t(),function(e){e.contentStyle["background-image"]="url('tmp/e/sf.png')";var t=e.contentStyle.width,s=e.contentStyle.height;e.dialogueStyle["border-radius"]=t/2+"px/"+s/2+"px",e.speakerStyle["background-color"]="#87CEEB",e.dialogueStyle["background-color"]="#87CEEB",e.choiceStyle["background-color"]="rgba(135, 206, 235, 0.5)"}(ns.themes.hina),ns.themes.theatre=t(),function(e){e.dialogueStyle["background-color"]="transparent",e.speakerStyle["background-color"]="transparent",e.dialStyle["font-size"]="200%",e.dialStyle["text-shadow"]="0 0 8px white",e.dialStyle["background-color"]="rgba(150, 150, 150, 0.5)"}(ns.themes.theatre),ns.themes.novel=t(),function(e){e.novelMode=!0,e.contentStyle.height="100%"}(ns.themes.novel);var s;if(ns.addTheme){ns.addTheme(s,t,e.width,e.height);for(var r=Object.keys(s),i=1;i<r;i++){if(ns.themes[r[i]])throw"Overide failed: theme "+r[i]+" already exists";ns.themes[r[i]]=s[r[i]]}}},ns.themes={},ns.frame=function(e){var t=ns.$frame.width(),s=ns.$frame.height();e?ns.controls.theme=e:e=ns.controls.theme,function(r){r.$main=$("<div></div>").css(e.mainstageStyle),r.$bg=$("<div></div>").css({width:t,height:s,transition:"all 0.5s","background-size":"100% 100%"}).appendTo(r.$main),r.$figure=$("<div></div>").css(e.figureStyle).appendTo(r.$main),r.$content=$("<div></div>").css(e.contentStyle).appendTo(r.$main),r.$dialogue=$("<div></div>").css(e.dialogueStyle).appendTo(r.$content),r.$speaker=$("<h2></h2>").css(e.speakerStyle).html("").appendTo(r.$content),r.$dialPrepend=$("<div></div>").css(e.dialStyle).html("").appendTo(r.$content),r.$dial=$("<p></p>").css(e.dialStyle).html("").appendTo(r.$content),r.$merge=$("<div></div>").css(e.mergeStyle).appendTo(r.$main).hide()}(ns.stage)},ns.stage={},ns.slide=function(){var e={},t=ns.state.stack,s=ns.state.state,r=ns.stage,i=ns.dp,n=ns.relation,a=(ns.resource,ns.controls.theme),o=ns.history;e.before=null,e.repaint=function(){e.speaker(),t.bg&&e.bg(),t.cg&&e.cg(),t.figure&&t.figure.length&&e.figure()},e.changeStack=function(e,r){if(!e)throw"No target for slide.jumpScript.";r=r||0,s.script=e,s.position=r,t=ns.dp.stackFix(e,r)},e.jumpScript=function(t,s){e.changeStack(t,s),e.move()},e.next=function(){ns.readyAfter(s.script,s.position);var r=i.getFromState().condition;if(r&&r.after&&(r.after===!1?ns.termination():Array.isArray(r.after)&&e.jumpScript(r.after[0],r.after[1])),e.before=$.extend({},t),s.position<i.get(s.script).length-1){s.position++;var a=i.get(s.script,s.position);t.speaker=a.speaker,t.dialogue=a.dialogue;var o=["cg","bg","bgm"];if(function(e){for(var s=0;s<e.length;s++)a[e[s]]&&(t[e[s]]=a[e[s]])}(o),a.figure){for(var c=0;c<a.figure.length;c++)""!=a.figure[c]&&(t.figure[c]=a.figure[c]);var l=[];for(c=0;c<t.figure.length;c++)0!==t.figure[c]&&"0"!==t.figure[c]&&l.push(t.figure[c]);t.figure=l.slice()}}else{var h=n[s.script];if(null===h)ns.$deferred.resolve();else for(var u=0;u<h.length;u++)if(h[u].condition)return e.changeStack(h[u].child,h[u].position),!0}},e.speaker=function(){t.speaker?r.$speaker.html(t.speaker).show():r.$speaker.hide()},e.changeBackgroundImage=function(s){e.before?e.before.cg==t.cg&&e.before.bg==t.bg||r.$bg.show().css({"background-image":"url("+s+")"}):r.$bg.css("background-image","url("+s+")"),e.before},e.bg=function(){0===t.bg||"0"===t.bg?(r.$main.css("background-image","none"),r.$bg.fadeOut("fast")):e.changeBackgroundImage(ns.resource.get("bg",t.bg))},e.cg=function(){0===t.cg||"0"===t.cg?(e.bg(),r.$figure.show()):(r.$figure.hide(),e.changeBackgroundImage(ns.resource.get("cg",t.cg)))},e.figures=[],e.figure=function(){e.figures=[],r.$figure.html("");for(var s=0;s<t.figure.length-1;s++)e.figures.push(ns.resource.get("figure",t.figure[s]));for(e.figures.push(ns.resource.get("figure",t.figure[s])),s=0;s<e.figures.length;s++)e.figures[s].css(ns.controls.theme.figureImageStyle).appendTo(r.$figure)};var c=t.dialogue;e.move=function(){var n=function(){var s=i.getFromState().merge;if(s){e.repaint(),r.$dial.html(i.getFromState().dialogue),e.deactive();var n=i.getFromState().mergeBody,o=i.getFromState().mergeFunctions;r.$merge.html("").show();for(var u=0;u<n.length;u++)!function(t){o[n[t]].condition?r.$merge.append($("<div></div>").css(a.choiceStyle).html(n[t]).click(function(s){s.stopPropagation(),e.active(),r.$merge.hide(),o[n[t]].callback()})):o[n[u]].gray&&r.$merge.append($("<div></div>").css(a.choiceStyle).css("background-color","rgba(0, 0, 0, 0.2)").html(n[t]))}(u)}else{c=t.dialogue;var d=ns.typer.flush;r.$dial.html(""),e.repaint();var f=function(t,s,i,n){return s<i.length-1?(r.$main.unbind("click").bind("click",function(){h(function(){for(var e="",t=0;t<s+1;t++)e+=i[t]+" ";return e},function(){f(t,s+1,i,n)})}),d(t,i[s],n,function(){r.$main.unbind("click").bind("click",function(){f(t,s+1,i,n)})})):(r.$main.unbind("click").bind("click",function(){l(c.join(" "))}),d(t,i[s++],n,function(){r.$main.unbind("click").bind("click",e.move)}))};Array.isArray(c)?f(r.$dial,0,c,20):(r.$main.unbind("click").bind("click",function(){l(c)}),d(r.$dial,c,20,function(){r.$main.unbind("click").bind("click",e.move)})),e.next()}},u=function(){o.pushAll(t);var s=a.dialStyle.top;if(a.novelMode){if(r.$dialPrepend.html("").show(),r.$dial.css({top:s*function(e){return e>0?2*e+1:1}(o.novel.stack.length-1)}),o.novel.stack.length>1)for(var c=0;c<o.novel.stack.length-1;c++){var l=o.novel.stack[c];r.$dialPrepend.append($("<div></div>").html(l.dialogue).css({"margin-top":s}))}}else r.$dialPrepend.hide();var h=i.getFromState().effect;if(h){var u=h.effectType;u&&u.sync?u&&u.sync&&(h.execute(),n()):(e.deactive(),u&&!u.deffered?h.execute(function(){e.active(),n()}):$.when(h.execute()).done(function(){e.active(),n()}))}else n()},d=function(){ns.readyBefore(s.script,s.position);var t=i.getFromState().condition;t?t&&t.before?u():e.next():u()};d()};var l=function(t){r.$dial.finish().html(t),r.$main.unbind("click").bind("click",e.move)},h=function(e,t){r.$dial.finish().html(e),r.$main.unbind("click").bind("click",t)};return e.active=function(){r.$main.bind("click",e.move)},e.deactive=function(){r.$main.unbind("click")},e},ns.slides={},ns.initMerge=function(){var e={},t=ns.dp;return e.add=function(e,s,r){var i=t.get(e,s);if(!i.merge)return console.log("Cannot add merge to a non-merge page."),!1;i.mergeFunctions={};for(var n=0;n<i.mergeBody.length;n++)i.mergeFunctions[i.mergeBody[n]]=r[n];return!0},e.listNonDistrib=function(){var e=[];t.throughout(function(t){t.merge&&!t.mergeFunctions&&e.push(t)}),e.length&&(console.log("Still merge pages not added"),console.log(e))},e},ns.media={images:[],audios:[]},ns.controls.statePassable=function(e){return e},ns.conditionStack={},ns.condition=function(e,t,s){var r=ns.conditionStack;r[e]?r[e][t]=s:(r[e]=[],r[e][t]=s)},ns.readyBefore=function(e,t){var s=ns.dp,r=ns.state.state,i=ns.conditionStack;i[e]&&i[e][t]&&(s.get(e,t).condition={},s.get(e,t).condition.before=ns.conditionStack[e][t](r,s).before)},ns.readyAfter=function(e,t){var s=ns.dp,r=ns.state.state,i=ns.conditionStack;i[e]&&i[e][t]&&(s.get(e,t).condition.after=ns.conditionStack[e][t](r,s).after)},ns.termination=function(){ns.$deferred.resolve(),console.log("Immediate termination has been applied.")},ns.history=function(){var e={};return e.stack=[],e.push=function(t){e.stack.push($.extend({},t))},e.novel={limit:5,stack:[]},e.novel.push=function(t){var s=e.novel;s.stack.push($.extend({},t)),s.stack.length>s.limit&&(s.stack.length=0)},e.pushAll=function(t){e.push(t),e.novel.push(t)},e}();